language: android
jdk:
- oraclejdk8
android:
  components:
  - tools
  - platform-tools
  - build-tools-29.0.2
  - android-29
  - extra-android-m2repository
  - sys-img-x86-android-29
  licenses:
  - android-sdk-license-.+

    # Emulator Management: Create, Start and Wait
before_script:
  - echo no | avdmanager create avd --force -n test -k "system-images;android-29;google_apis_playstore;x86" -c 100M
    #  - echo no | android create avd --force -n test -t android-29 --abi armeabi-v7a -c 100M
  - emulator -avd test -no-audio -no-window &
  - android-wait-for-emulator
  - adb shell input keyevent 82 &
script:
- "./gradlew check connectedAndroidTest --stacktrace"
after_success:
- gradle/deploy_snapshot.sh
before_install:
- yes | sdkmanager "platforms;android-29"
branches:
  except:
  - gh-pages
notifications:
  email: false
sudo: false
cache:
  directories:
  - "$HOME/.m2"
  - "$HOME/.gradle"

